<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Teste de Envio de Mensagem no WhatsApp</title>
</head>
<body>

<!-- Este elemento <a> é usado apenas para fins de formatação, não tem efeito na execução do script -->
<a id="whatsappLink" style="display: none;"></a>

<script>
    // Chama a função enviarWhatsapp assim que a página é carregada
    window.onload = function() {
        enviarWhatsapp();
    };

    function enviarWhatsapp() {
        // Número de telefone
        var numeroTelefone = "+5535997660759";
        
        // Texto padrão para a mensagem no WhatsApp
        var textoWhatsapp = "ATENÇÃO NÃO APAGAR - Você Acaba de Ganhar uma Consulta Totalmente Grátis- Protocolo nº";
        
        // Obter o valor de UTM_source da URL
        var utmSource = getParameterByName('utm_source');
        
        // Adicionar UTM_source à mensagem do WhatsApp
        if (utmSource) {
            textoWhatsapp += "%0A" + utmSource;
        }
        
        // Montar a URL do link do WhatsApp
        var whatsappLink = "https://api.whatsapp.com/send?phone=" + numeroTelefone + "&text=" + textoWhatsapp;
        
        // Redirecionar para a URL do WhatsApp
        document.getElementById('whatsappLink').href = whatsappLink;
        document.getElementById('whatsappLink').click();
    }
    
    // Função para obter parâmetros da URL
    function getParameterByName(name, url) {
        if (!url) url = window.location.href;
        name = name.replace(/[\[\]]/g, "\\$&");
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, " "));
    }
</script>

</body>
</html>
